"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[5199],{97108:function(L,i,e){e.d(i,{R:function(){return r}});var t=e(32735),l=e(61489),o=e(20108);function r(c={},a={}){const{id:n="",...g}=c,{get:u}=(0,l.kY)(),{data:s,isError:P,isLoading:D,refetch:y}=(0,o.useQuery)(["users",n,g],async()=>{const{data:{data:f}}=await u(`/admin/users/${n}`,{params:g});return f},a);return{users:t.useMemo(()=>n&&s?[s]:Array.isArray(s?.results)?s.results:[],[s,n]),pagination:t.useMemo(()=>s?.pagination??null,[s?.pagination]),isLoading:D,isError:P,refetch:y}}},59092:function(L,i,e){var t=e(32735),l=e(77981),o=e(91779),r=e(61489),c=e(68527),a=e(60216),n=e.n(a),g=e(67879);const u=({displayedFilters:s})=>{const[P,D]=(0,t.useState)(!1),{formatMessage:y}=(0,g.Z)(),p=(0,t.useRef)(),f=()=>{D(T=>!T)};return t.createElement(t.Fragment,null,t.createElement(l.x,{paddingTop:1,paddingBottom:1},t.createElement(o.z,{variant:"tertiary",ref:p,startIcon:t.createElement(c.Z,null),onClick:f,size:"S"},y({id:"app.utils.filters",defaultMessage:"Filters"})),P&&t.createElement(r.J5,{displayedFilters:s,isVisible:P,onToggle:f,source:p})),t.createElement(r.W$,{filtersSchema:s}))};u.propTypes={displayedFilters:n().arrayOf(n().shape({name:n().string.isRequired,metadatas:n().shape({label:n().string}),fieldSchema:n().shape({type:n().string})})).isRequired},i.Z=u},99528:function(L,i,e){e.d(i,{W:function(){return pe},Z:function(){return Ze}});var t=e(32735),l=e(95162),o=e(64092),r=e(95181),c=e(56932),a=e(61489),n=e(33348),g=e.n(n),u=e(67879),s=e(20108),P=e(15062),D=e(53038),y=e(97108),p=e(9592),f=e(30305),T=e(59092),R=e(91779),ae=e(50720),ne=e(60216),E=e.n(ne);const q=({onClick:d})=>{const{formatMessage:M}=(0,u.Z)();return t.createElement(R.z,{onClick:d,startIcon:t.createElement(ae.Z,null),size:"S"},M({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}))};q.propTypes={onClick:E().func.isRequired};var Z=e(1690),se=e(45037),J=e(27947),re=e(96669),b=e(8365),F=e(84642),O=e(14763),$=e(77981),fe=e(63318),Me=e(94997),le=e(90869);const oe=({canDelete:d,headers:M,entriesToDelete:I,onClickDelete:k,onSelectRow:N,withMainAction:j,withBulkActions:W,rows:B})=>{const{push:C,location:{pathname:V}}=(0,D.k6)(),{formatMessage:A}=(0,u.Z)();return t.createElement(Z.p,null,B.map(m=>{const z=I.findIndex(S=>S===m.id)!==-1;return t.createElement(se.Tr,{key:m.id,...(0,a.X7)({fn:()=>C(`${V}/${m.id}`),condition:W})},j&&t.createElement(J.Td,{...a.UW},t.createElement(re.C,{"aria-label":A({id:"app.component.table.select.one-entry",defaultMessage:"Select {target}"},{target:(0,le.Pp)(m.firstname,m.lastname)}),checked:z,onChange:()=>{N({name:m.id,value:!z})}})),M.map(({key:S,cellFormatter:H,name:K,...Y})=>t.createElement(J.Td,{key:S},typeof H=="function"?H(m,{key:S,name:K,formatMessage:A,...Y}):t.createElement(b.Z,{textColor:"neutral800"},m[K]||"-"))),W&&t.createElement(J.Td,null,t.createElement(F.k,{justifyContent:"end"},t.createElement(O.h,{onClick:()=>C(`${V}/${m.id}`),label:A({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:(0,le.Pp)(m.firstname,m.lastname)}),noBorder:!0,icon:t.createElement(fe.Z,null)}),d&&t.createElement($.x,{paddingLeft:1,...a.UW},t.createElement(O.h,{onClick:()=>k(m.id),label:A({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:(0,le.Pp)(m.firstname,m.lastname)}),noBorder:!0,icon:t.createElement(Me.Z,null)})))))}))};oe.defaultProps={canDelete:!1,entriesToDelete:[],onClickDelete(){},onSelectRow(){},rows:[],withBulkActions:!1,withMainAction:!1},oe.propTypes={canDelete:E().bool,entriesToDelete:E().array,headers:E().array.isRequired,onClickDelete:E().func,onSelectRow:E().func,rows:E().array,withBulkActions:E().bool,withMainAction:E().bool};var ve=oe,he=e(21223),ye=e(98887),Pe=e(87674),me=e(10710),ie=e(97037),De=e(74973),Ce=e(79129),Oe=e(2748),Ae=e(92802),Le=e(47577),Te=e(18703),X=e(24346);const ue={firstname:"",lastname:"",email:"",roles:[]},Re=[],Ie=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0}]],Ue=X.Ry().shape({firstname:X.Z_().trim().required(a.I0.required),lastname:X.Z_(),email:X.Z_().email(a.I0.email).required(a.I0.required),roles:X.IX().min(1,a.I0.required).required(a.I0.required)}),Be={create:{buttonSubmitLabel:{id:"app.containers.Users.ModalForm.footer.button-success",defaultMessage:"Invite user"},isDisabled:!1,next:"magic-link"},"magic-link":{buttonSubmitLabel:{id:"global.finish",defaultMessage:"Finish"},isDisabled:!0,next:null}},Ee=({onSuccess:d,onToggle:M})=>{const[I,k]=(0,t.useState)("create"),[N,j]=(0,t.useState)(!1),[W,B]=(0,t.useState)(null),{formatMessage:C}=(0,u.Z)(),V=(0,a.lm)(),{lockApp:A,unlockApp:m}=(0,a.o1)(),{post:z}=(0,a.kY)(),S=(0,p.c)(Re,async()=>(await e.e(311).then(e.bind(e,40311))).ROLE_LAYOUT,{combine(h,x){return[...h,x]},defaultValue:[]}),H=(0,p.c)(ue,async()=>(await e.e(311).then(e.bind(e,40311))).FORM_INITIAL_VALUES,{combine(h,x){return{...h,...x}},defaultValue:ue}),K=(0,p.c)(Le.A,async()=>(await e.e(1727).then(e.bind(e,81727))).MagicLinkEE),Y=(0,s.useMutation)(h=>z("/admin/users",h),{async onSuccess({data:h}){B(h.data.registrationToken),await d(),te(),j(!1)},onError(h){throw j(!1),V({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),h},onSettled(){m()}}),w=C({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}),ee=async(h,{setErrors:x})=>{A(),j(!0);try{await Y.mutateAsync(h)}catch(G){m(),G?.response?.data?.error.message==="Email already taken"&&x({email:G.response.data.error.message})}},te=()=>{v?k(v):M()},{buttonSubmitLabel:_,isDisabled:Q,next:v}=Be[I],be=I==="create"?t.createElement(R.z,{type:"submit",loading:N},C(_)):t.createElement(R.z,{type:"button",loading:N,onClick:M},C(_));return K?t.createElement(he.P,{onClose:M,labelledBy:"title"},t.createElement(ye.x,null,t.createElement(Ce.O,{label:w},t.createElement(Oe.$,{isCurrent:!0},w))),t.createElement(Ae.J9,{enableReinitialize:!0,initialValues:H,onSubmit:ee,validationSchema:Ue,validateOnChange:!1},({errors:h,handleChange:x,values:G})=>t.createElement(a.l0,null,t.createElement(Pe.f,null,t.createElement(F.k,{direction:"column",alignItems:"stretch",gap:6},I!=="create"&&t.createElement(K,{registrationToken:W}),t.createElement($.x,null,t.createElement(b.Z,{variant:"beta",as:"h2"},C({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"User details"})),t.createElement($.x,{paddingTop:4},t.createElement(F.k,{direction:"column",alignItems:"stretch",gap:1},t.createElement(me.r,{gap:5},Ie.map(de=>de.map(U=>t.createElement(ie.P,{key:U.name,...U.size},t.createElement(a.jm,{...U,disabled:Q,error:h[U.name],onChange:x,value:G[U.name]})))))))),t.createElement($.x,null,t.createElement(b.Z,{variant:"beta",as:"h2"},C({id:"global.roles",defaultMessage:"User's role"})),t.createElement($.x,{paddingTop:4},t.createElement(me.r,{gap:5},t.createElement(ie.P,{col:6,xs:12},t.createElement(Te.Z,{disabled:Q,error:h.roles,onChange:x,value:G.roles})),S.map(de=>de.map(U=>t.createElement(ie.P,{key:U.name,...U.size},t.createElement(a.jm,{...U,disabled:Q,onChange:x,value:G[U.name]}))))))))),t.createElement(De.m,{startActions:t.createElement(R.z,{variant:"tertiary",onClick:M,type:"button"},C({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:be})))):null};Ee.propTypes={onToggle:E().func.isRequired,onSuccess:E().func.isRequired};var Se=Ee;const ce=({pagination:d})=>t.createElement($.x,{paddingTop:4},t.createElement(F.k,{alignItems:"flex-end",justifyContent:"space-between"},t.createElement(a.v4,null),t.createElement(a.tU,{pagination:d})));ce.defaultProps={pagination:{pageCount:0,pageSize:10,total:0}},ce.propTypes={pagination:E().shape({page:E().number,pageCount:E().number,pageSize:E().number,total:E().number})};var xe=ce,We=[{name:"firstname",metadatas:{label:"Firstname"},fieldSchema:{type:"string"}},{name:"lastname",metadatas:{label:"Lastname"},fieldSchema:{type:"string"}},{name:"email",metadatas:{label:"Email"},fieldSchema:{type:"email"}},{name:"username",metadatas:{label:"Username"},fieldSchema:{type:"string"}},{name:"isActive",metadatas:{label:"Active user"},fieldSchema:{type:"boolean"}}],Ke=[{name:"firstname",key:"firstname",metadatas:{label:{id:"Settings.permissions.users.firstname",defaultMessage:"Firstname"},sortable:!0}},{name:"lastname",key:"lastname",metadatas:{label:{id:"Settings.permissions.users.lastname",defaultMessage:"Lastname"},sortable:!0}},{key:"email",name:"email",metadatas:{label:{id:"Settings.permissions.users.email",defaultMessage:"Email"},sortable:!0}},{key:"roles",name:"roles",metadatas:{label:{id:"Settings.permissions.users.roles",defaultMessage:"Roles"},sortable:!1},cellFormatter({roles:d},{formatMessage:M}){return t.createElement(b.Z,{textColor:"neutral800"},d.map(I=>M({id:`Settings.permissions.users.${I.code}`,defaultMessage:I.name})).join(`,
`))}},{key:"username",name:"username",metadatas:{label:{id:"Settings.permissions.users.username",defaultMessage:"Username"},sortable:!0}},{key:"isActive",name:"isActive",metadatas:{label:{id:"Settings.permissions.users.user-status",defaultMessage:"User status"},sortable:!1},cellFormatter({isActive:d},{formatMessage:M}){return t.createElement(F.k,null,t.createElement(a.qb,{isActive:d,variant:d?"success":"danger"}),t.createElement(b.Z,{textColor:"neutral800"},M({id:d?"Settings.permissions.users.active":"Settings.permissions.users.inactive",defaultMessage:d?"Active":"Inactive"})))}}];const ge=["ee","license-limit-info"],pe=()=>{const{post:d}=(0,a.kY)(),{formatAPIError:M}=(0,a.So)(),[I,k]=(0,t.useState)(!1),N=(0,P.v9)(f._),{allowedActions:{canCreate:j,canDelete:W,canRead:B}}=(0,a.ss)(N.settings.users),C=(0,s.useQueryClient)(),V=(0,a.lm)(),{formatMessage:A}=(0,u.Z)(),{search:m}=(0,D.TH)();(0,a.go)();const{users:z,pagination:S,isError:H,isLoading:K,refetch:Y}=(0,y.R)(g().parse(m,{ignoreQueryPrefix:!0}),{cacheTime:0,enabled:B}),w=(0,p.c)(q,async()=>(await e.e(2379).then(e.bind(e,42379))).CreateActionEE),ee=Ke.map(v=>({...v,metadatas:{...v.metadatas,label:A(v.metadatas.label)}})),te=A({id:"global.users",defaultMessage:"Users"}),_=()=>{k(v=>!v)},Q=(0,s.useMutation)(async v=>{await d("/admin/users/batch-delete",{ids:v})},{async onSuccess(){await Y(),await C.refetchQueries(ge)},onError(v){V({type:"warning",message:{id:"notification.error",message:M(v),defaultMessage:"An error occured"}})}});return w?t.createElement(l.o,{"aria-busy":K},t.createElement(a.SL,{name:"Users"}),t.createElement(o.T,{primaryAction:j&&t.createElement(w,{onClick:_}),title:te,subtitle:A({id:"Settings.permissions.users.listview.header.subtitle",defaultMessage:"All the users who have access to the Strapi admin panel"})}),B&&t.createElement(r.Z,{startActions:t.createElement(t.Fragment,null,t.createElement(a.m,{label:A({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:te})}),t.createElement(T.Z,{displayedFilters:We}))}),t.createElement(c.D,{canRead:B},!B&&t.createElement(a.ZF,null),H&&t.createElement("div",null,"TODO: An error occurred"),B&&t.createElement(t.Fragment,null,t.createElement(a.tM,{contentType:"Users",isLoading:K,onConfirmDeleteAll:Q.mutateAsync,onConfirmDelete:v=>Q.mutateAsync([v]),headers:ee,rows:z,withBulkActions:!0,withMainAction:W},t.createElement(ve,{canDelete:W,headers:ee,rows:z,withBulkActions:!0,withMainAction:W})),S&&t.createElement(xe,{pagination:S}))),I&&t.createElement(Se,{onSuccess:async()=>{await Y(),await C.refetchQueries(ge)},onToggle:_})):null};var Ze=()=>{const d=(0,p.c)(pe,async()=>(await e.e(2801).then(e.bind(e,12801))).UserListPageEE);return d?t.createElement(d,null):null}},25691:function(L,i,e){e.r(i);var t=e(32735),l=e(61489),o=e(15062),r=e(30305),c=e(99528);const a=()=>{const n=(0,o.v9)(r._);return t.createElement(l.O4,{permissions:n.settings.users.main},t.createElement(c.Z,null))};i.default=a},84024:function(L,i,e){var t=e(32735),l=e(14763),o=e(61489),r=e(94958),c=e(60216),a=e.n(c),n=e(67879);const g=({children:u,target:s})=>{const P=(0,o.lm)(),{formatMessage:D}=(0,n.Z)(),{copy:y}=(0,o.VP)(),p=D({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),f=async()=>{await y(s)&&P({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(o.Y_,{endAction:t.createElement(l.h,{label:p,noBorder:!0,icon:t.createElement(r.Z,null),onClick:f}),title:s,titleEllipsis:!0,subtitle:u,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};g.propTypes={children:a().oneOfType([a().element,a().string]).isRequired,target:a().string.isRequired},i.Z=g},47577:function(L,i,e){e.d(i,{A:function(){return n}});var t=e(32735),l=e(60216),o=e.n(l),r=e(67879),c=e(35231),a=e(84024);const n=({registrationToken:g})=>{const{formatMessage:u}=(0,r.Z)(),s=`${window.location.origin}${c.Z}auth/register?registrationToken=${g}`;return t.createElement(a.Z,{target:s},u({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};n.defaultProps={registrationToken:""},n.propTypes={registrationToken:o().string}},18703:function(L,i,e){var t=e(32735),l=e(16773),o=e(40260),r=e(61489),c=e(75760),a=e(60216),n=e.n(a),g=e(67879),u=e(20108),s=e(8471);const P=(0,s.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,D=s.ZP.div`
  animation: ${P} 2s infinite linear;
`,y=()=>t.createElement(D,null,t.createElement(c.Z,null)),p=async()=>{const{get:T}=(0,r.tg)(),{data:R}=await T("/admin/roles");return R.data},f=({disabled:T,error:R,onChange:ae,value:ne})=>{const{status:E,data:q}=(0,u.useQuery)(["roles"],p,{staleTime:5e4}),{formatMessage:Z}=(0,g.Z)(),se=R?Z({id:R,defaultMessage:R}):"",J=Z({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),re=Z({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),b=Z({id:"app.components.Select.placeholder",defaultMessage:"Select"}),F=E==="loading"?t.createElement(y,null):void 0;return t.createElement(l.P,{id:"roles",disabled:T,error:se,hint:re,label:J,name:"roles",onChange:O=>{ae({target:{name:"roles",value:O}})},placeholder:b,multi:!0,startIcon:F,value:ne.map(O=>O.toString()),withTags:!0,required:!0},(q||[]).map(O=>t.createElement(o.W,{key:O.id,value:O.id.toString()},Z({id:`global.${O.code}`,defaultMessage:O.name}))))};f.defaultProps={disabled:!1,error:void 0},f.propTypes={disabled:n().bool,error:n().string,onChange:n().func.isRequired,value:n().array.isRequired},i.Z=f},95181:function(L,i,e){e.d(i,{Z:function(){return o}});var t=e(74512),l=e(84642);const o=({startActions:r,endActions:c})=>!r&&!c?null:(0,t.jsxs)(l.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,t.jsx)(l.k,{gap:2,wrap:"wrap",children:r}),(0,t.jsx)(l.k,{gap:2,shrink:0,wrap:"wrap",children:c})]})},79129:function(L,i,e){e.d(i,{O:function(){return u}});var t=e(74512),l=e(32735),o=e(8471),r=e(77981),c=e(8365);const a=()=>(0,t.jsx)(r.x,{"aria-hidden":!0,paddingLeft:1,paddingRight:1,children:(0,t.jsx)(c.Z,{variant:"pi",textColor:"neutral500",children:"/"})});a.displayName="Divider";var n=e(84642);const g=(0,o.ZP)(n.k)`
  // CrumbLinks do have padding-x, because they need to have a
  // interaction effect, which mis-aligns the breadcrumbs on the left.
  // This normalizes the behavior by moving the first item to left by
  // the same amount it has inner padding
  :first-child {
    margin-left: ${({theme:s})=>`calc(-1*${s.spaces[2]})`};
  }
`,u=({label:s,children:P,...D})=>{const y=l.Children.toArray(P);return(0,t.jsx)(r.x,{"aria-label":s,...D,children:(0,t.jsx)(g,{as:"ol",children:l.Children.map(y,(p,f)=>{const T=y.length>1&&f+1<y.length;return(0,t.jsxs)(n.k,{inline:!0,as:"li",children:[p,T&&(0,t.jsx)(a,{})]})})})})};u.displayName="Breadcrumbs"},2748:function(L,i,e){e.d(i,{$:function(){return r}});var t=e(74512),l=e(77981),o=e(8365);const r=({children:c,isCurrent:a=!1,...n})=>(0,t.jsx)(l.x,{paddingLeft:2,paddingRight:2,paddingTop:1,paddingBottom:1,children:(0,t.jsx)(o.Z,{variant:"pi",textColor:"neutral800",fontWeight:a?"bold":"normal","aria-current":a,...n,children:c})});r.displayName="Crumb"},50720:function(L,i,e){e.d(i,{Z:function(){return o}});var t=e(74512);const l=r=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...r,children:[(0,t.jsx)("path",{fill:"#32324D",d:"M0 2.8A.8.8 0 0 1 .8 2h22.4a.8.8 0 0 1 .8.8v2.71a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V2.8Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873ZM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555Z"})]}),o=l}}]);
